{% extends "base.html" %}

{% block content-inner %}
<div class="row">
  <div class="span10">
    {% if user.is_authenticated and editing %}
        <form action="{% url 'edit_repositories' %}" method="post">
          {% csrf_token %}
          <button type="submit" name="edit" value="true">Add</button>
        </form>
    {% endif %}
    
    <table class="table table-bordered table-striped">
      <tbody>
        {% if edit %}
          <form action="{% url 'edit_repositories' %}" method="post">
            {% csrf_token %}
            <tr>
              <td>
                <input type="text" name="name" style="width: 400px"></input>
                <select multiple name="campuses" class="chosen-select">
                  {% for campus in campuses %}
                  <option value="{{ campus.id }}">
                    {{ campus.name }}
                  </option>
                  {% endfor %}
                </select>
                <input type="submit" value="Save"></input>
              </td>
            </tr>
          </form>
        {% endif %}
        {% for repository in repositories %}
        <tr>
          <td>
            {{ repository.name }}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  <div class="span2">
    {% block navbar-campus %}
    <h4>Limit by campus</h4>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container">
          <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <!-- Everything you want hidden at 940px or less, place within here -->
          <div class="nav-collapse">
            <!-- .nav, .navbar-search, .navbar-form, etc -->
            <ul class="nav nav-stacked">
              {% for campus_iter in campuses %}
              <li class="{% if campus_iter == campus %}active{% endif %}">
                {% if user.is_authenticated and editing %}
                  {% if campus_iter == campus %}
                    <a href="{% url "edit_repositories" %}">X {{ campus_iter.name }}</a>
                  {% else %}
                    <a href="{% url "edit_repositories" campus_slug=campus_iter.slug %}">{{ campus_iter.name }}</a>
                  {% endif %}
                {% else %}
                  {% if campus_iter == campus %}
                    <a href="{% url "repositories" %}">X {{ campus_iter.name }}</a>
                  {% else %}
                    <a href="{% url "repositories" campus_slug=campus_iter.slug %}">{{ campus_iter.name }}</a>
                  {% endif %}
                {% endif %}
              </li>
              {% endfor %}
            </ul>
          </div>
        </div>
      </div>
    </div>
    {% endblock %}
  </div>
</div>
{% endblock content-inner %}

{% if user.is_authenticated %}
{% block inlineScripts %}
<script>
    $(".chosen-select").chosen();
</script>
{% endblock %}
{% endif %}